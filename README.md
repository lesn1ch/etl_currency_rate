# **Airflow ETL Pipeline для курсов валют**

## **Описание проекта**
Этот проект представляет собой ETL-пайплайн (Extract, Transform, Load), реализованный с использованием Apache Airflow. Пайплайн выполняет следующие задачи:
1. **Extract**: Получение данных о курсах валют Центрального Банка РФ через API.
2. **Transform**: Преобразование JSON-данных в табличный формат (DataFrame).
3. **Load**: Загрузка данных в таблицу PostgreSQL.

---

## **Требования**
Для запуска проекта вам понадобятся:
- Docker и Docker Compose
- Python 3.8+
- База данных PostgreSQL

---

## **Как это работает**
1. **Extract**:
   - Задача `extract_data` отправляет GET-запрос к API ЦБ РФ и получает JSON с курсами валют.
   - Если запрос завершается ошибкой, задача логирует проблему и завершается с ошибкой.

2. **Transform**:
   - Задача `transform_data` преобразует JSON в DataFrame и передает его в XCom для последующей обработки.

3. **Load**:
   - Задача `create_valute_table` создает таблицу `currency_rates` в PostgreSQL, если она еще не существует.
   - Задача `load_data_to_postgres` вставляет данные из DataFrame в таблицу.

---

## **Дополнительные замечания**
1. **Обработка ошибок**:
   - Если API недоступен, DAG завершится с ошибкой. Вы можете настроить повторные попытки выполнения задачи с помощью параметров `retries` и `retry_delay`.

2. **Масштабирование**:
   - Для больших объемов данных рекомендуется использовать массовую вставку (например, `COPY` в PostgreSQL) вместо построчной вставки.

3. **Мониторинг**:
   - Настройте уведомления (например, через Slack или email) для отслеживания ошибок.

4. **Лицензия**:
   - Проект распространяется под лицензией MIT.

---

## **Ссылки**
- [Airflow Documentation](https://airflow.apache.org/docs/)
- [Используемое API](https://www.cbr-xml-daily.ru/)
- [Репозиторий с готовыми докер образами](https://github.com/puckel/docker-airflow)

---
